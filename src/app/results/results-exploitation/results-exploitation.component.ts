import { Component, OnInit, Input, OnChanges, SimpleChanges } from '@angular/core';

//Language
import { Language } from '../../language/language';
import { LanguageService } from '../../language/language.service';

//Objects
import { Company }  from '../../objects/company';
import { Product }    from '../../objects/product';
import { Employee } from '../../objects/salary';
import { Result }   from '../../objects/result';

//Service
import { DecisionsService } from '../../service/decisions.service';

@Component({
  selector: 'results-exploitation',
  templateUrl: './results-exploitation.component.html',
  styleUrls: ['./results-exploitation.component.css']
})
export class ResultsExploitationComponent implements OnInit, OnChanges {

  @Input() company: Company;
  @Input() periode: number;
  largerAttracts: Product;

  //Production
  exploitation: any[];
  decisionsMarketing: any[];
  lang: Language;


  constructor(private decision: DecisionsService, private langServ: LanguageService) {
    this.lang = langServ.getLanguageConstructor();
    langServ.getLanguage().subscribe( lang => this.lang = lang );
  }

  ngOnInit() {
    //largerAttracts
    this.largerAttracts = this.decision.foundLargerProduct(this.company.companyProduct);

    this.decisionsMarketing = [];
    Object.keys(this.company.decision.marketingDecision).map( (key) => this.decisionsMarketing.push(this.company.decision.marketingDecision[key]) );

    //Exploitation
    this.exploitation = [];
    var resultPeriode = "result" + this.periode;
    Object.keys(this.company.result).map( (keyResult) => {
      if(keyResult === resultPeriode){
        Object.keys(this.company.result[keyResult].choice).map( (key) =>{
          this.exploitation.push(this.company.result[keyResult].choice[key]);
        });
      }
    });
  }

  ngOnChanges(changes: SimpleChanges){
    this.ngOnInit();
  }



}
